Network intrusion prevention and detection system